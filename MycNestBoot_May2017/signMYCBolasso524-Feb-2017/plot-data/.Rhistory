sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5000, xmax=7500, ymax=10000,
fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5000, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
d = cc[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
d = cc[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
dd = cc[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
dd = cc[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(3.6, 4)) + scale_y_log10(limits=c(3.69,4))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(3.6, 4)) + scale_y_log10(limits=c(3.69,4))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(3.6, 40)) + scale_y_log10(limits=c(3.69,40))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(3.6, 4000)) + scale_y_log10(limits=c(3.69,4000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(4000, 7500)) + scale_y_log10(limits=c(5000,10000))
continuous
scale_x_log
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_log10(limits=c(4000, 7500)) + scale_y_log10(limits=c(5000,10000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11<-ggplot(cc[1:1701,],aes(log10(x), log10(y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5000, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11<-ggplot(cc[1:1701,],aes(x, y))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5000, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5000, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5000,10000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes(log10(x), log10(y)))+ geom_point()
p11
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
sub <- p11 + geom_rect(data=e^cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub <- p11 + geom_rect(data=exp^cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub <- p11 + geom_rect(data=1ecc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
summary(cc$`WRSS of prediction of Y`)[5]
summary(cc$`WRSS of prediction of Y`)
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[1]]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[1]]
p11<-ggplot(cc[1:1701,],aes(log10(x), log10(y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[1]]
summary(cc$`WRSS of prediction of Y`)[1]
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[2]]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[2]]
p11<-ggplot(cc[1:1701,],aes(log10(x), log10(y)))+ geom_point()
p11<-ggplot(cc[1:567,],aes(log10(x), log10(y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[567,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11
sub <- p11 + geom_rect(data=cc[567,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
sub
sub <- p11 + geom_rect(data=cc[1:567,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:567,],aes((x), (y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:567,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
multiplot(p1,p3,p4,p5,p7,p8,cols=2)
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]]
p11<-ggplot(cc[1:1701,],aes(log10(x), log10(y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
cc$`WRSS of prediction of Y`)[5]
summary(cc$`WRSS of prediction of Y`)[5]
summary(cc$`WRSS of prediction of Y`)
summary(cc$`WRSS of prediction of Y`)[6]
summary(cc$`WRSS of prediction of Y`)[6]/10
summary(cc$`WRSS of prediction of Y`)[6]/1e7
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]/1e7]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <summary(cc$`WRSS of prediction of Y`)[5]/1e7]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5]/1e7)]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5]/1e7)]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
log10(cc)
log10(cc[2:end,])
log10(cc[,2:end])
log10(cc)
cc[1:2,]
cc[,1:2]
cc[,2:3]
log10(cc[,2:3])
log10(cc[,2:end])
log10(cc[,2:22])
log10(cc[,2:22])
log10(cc[,2:21])
dd<-log10(cc[,2:21])
View(dd)
dd<-log10(cc[,2:21])
x = dd$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
y = dd$`Y pred for LOO`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(dd[1:1701,],aes((x), (y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
x = cc$`WRSS of prediction of Y`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
y = cc$`Y pred for LOO`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point()
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=75000, ymax=100000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 75000)) + scale_y_continuous(limits=c(5500,100000))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=75000, ymin=5500, ymax=70000) +
scale_x_continuous(limits=c(4000, 75000)) + scale_y_continuous(limits=c(5500,100000))
p11 + annotation_custom(ggplotGrob(sub), xmin=60000, xmax=75000, ymin=55000, ymax=70000) +
scale_x_continuous(limits=c(40000, 75000)) + scale_y_continuous(limits=c(55000,100000))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
View(cc)
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(color=ss)
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(color=cc$ss)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
s = cc$`ss`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(color=s)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
s = cc$`strata`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(color=s)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
s = cc$`ss`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(color=s)
p11
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(groups(s))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)))
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = 4)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = [4,1])
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = strata)
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = cc$strata)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
sss = cc$`strata`[cc$`WRSS of prediction of Y` <(summary(cc$`WRSS of prediction of Y`)[5])]
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = cc$sss)
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p6<-ggplot(cc,aes(x = cc$`RSS(Pobs-Ppred) LOO`)) + stat_ecdf(aes(colour = ss))+geom_point(aes(x = cc$`RSS(Pobs-Ppred) LOO`[6],y=1))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2,shape=s)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2,shape=sss)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000))
opts(title="geom_point", plot.title=theme_text(size=40, vjust=1.5))
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)+
opts(title="WRSS of prediction of Y v Y pred for LOO", plot.title=theme_text(size=40, vjust=1.5))
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Inferred v Random Performance")
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)+ labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Inferred v Random Performance")
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Inferred v Random Performance")
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)+ labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Inferred v Random Performance")
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", subtitle="Zoom of Inferred v Random Performance")
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)+ labs(x="WRSS of prediction of Y",y="Y pred for LOO", subtitle="Inferred v Random Performance")
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Zoom of Inferred v Random Performance")
clear p11
re(p11)
rm(p11)
p11<-ggplot(cc[1:1701,],aes((x), (y)))+ geom_point(aes(colour = factor(s)),size = sss+2)+ labs(x="WRSS of prediction of Y",y="Y pred for LOO", subtitle="Inferred v Random Performance")
sub <- p11 + geom_rect(data=cc[1:1701,],xmin=4000, ymin=5500, xmax=7500, ymax=10000, fill="blue", alpha=0.5)
sub$layers <- rev(sub$layers) # draw rect below
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Zoom of Inferred v Random Performance")
p11 + annotation_custom(ggplotGrob(sub), xmin=6000, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Zoomed view of")
p11 + annotation_custom(ggplotGrob(sub), xmin=5500, xmax=7500, ymin=5500, ymax=7000) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Zoomed view of")
p11 + annotation_custom(ggplotGrob(sub), xmin=5500, xmax=7500, ymin=5500, ymax=7500) +
scale_x_continuous(limits=c(4000, 7500)) + scale_y_continuous(limits=c(5500,10000)) + labs(x="WRSS of prediction of Y",y="Y pred for LOO", title="Zoomed view of")
shiny::runApp('Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('Dropbox/SciLifeLab/git/R/GSnetApp')
plotly_POST()
runApp('Dropbox/SciLifeLab/git/R/GSnetApp')
wee<-paste(input$method,input$data,"linkplotdata",sep="")
datum<-(eee[[wee]])
data<-(datum[[input$sparsity]])
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
zee<-paste(input$method,input$data,"linkcutdata",sep="")
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[input$sparsity]])
cutoff<-data.frame(cutoff)
if (identical(input$data, "MYCsign")){
cutoff$CUT<-cutoff$support.at.cross2}
else{
cutoff$CUT<-cutoff$support.at.cross}
long <- melt(data, id.vars = c("bins"))
long$bins<-as.numeric(long$bins)
long$value<-as.numeric(long$value)
intercept1=cutoff$support.at.cross2[2]
ccc=max(long[c(10:1001,1010:2002),]$value)
gg<-ggplot(data=long[c(10:1001,1010:2002),],aes(bins/1000,value/max(value),colour=variable))+geom_line()+
geom_line(data=long[2003:4004,],aes(bins/1000,value,colour=variable))+ xlab("Support")+ylab("Overlap")+
# geom_vline(xintercept=intercept1)+
# scale_x_continuous(sec.axis = sec_axis(~./1000))+
scale_y_continuous(sec.axis = sec_axis(~.*ccc,name="Frequency"))
ww<-plotly_build(gg) %>% add_trace(x = cutoff$CUT[1], y = c(0,1),type='scatter',mode='lines',name="support at cutoff") %>% add_trace(x = cutoff$sparsity[1], y = c(0,1),type='scatter',mode='lines',name="sparsity")
library(shiny)
library(DT)
library(rcytoscapejs)
library(networkD3)
library(network)
library(reshape2)
library(intergraph)
library(plotly)
library(ggplot2)
library(igraph)
require(visNetwork, quietly = TRUE)
#### LOAD ####
# setwd("~/Dropbox/SciLifeLab/git/R/GSnetApp/")
load("lassodataBSUB2017-02-06.rdata")
load("lassodataMYC2017-02-06.rdata")
load("lassodataMYCsign2017-02-06.rdata")
load("lscodataBSUB2017-02-06.rdata")
load("lscodataMYC2017-02-06.rdata")
load("lscodataMYCsign2017-02-06.rdata")
load("tlscodataBSUB2017-02-06.rdata")
load("tlscodataMYC2017-02-06.rdata")
load("tlscodataMYCsign2017-02-06.rdata")
# ### LOAD PLOT DATA ###
load("lassoMYCsignlinkplotdata2017-02-08.rdata")
load("lassoMYClinkplotdata2017-02-08.rdata")
load("lassoBSUBlinkplotdata2017-02-08.rdata")
load("lscoMYCsignlinkplotdata2017-02-14.rdata")
load("lscoMYClinkplotdata2017-02-08.rdata")
load("lscoBSUBlinkplotdata2017-02-08.rdata")
load("tlscoMYCsignlinkplotdata2017-02-08.rdata")
load("tlscoMYClinkplotdata2017-02-08.rdata")
load("tlscoBSUBlinkplotdata2017-02-08.rdata")
setwd("~/Dropbox/SciLifeLab/git/R/GSnetApp/")
load("lassodataBSUB2017-02-06.rdata")
load("lassodataMYC2017-02-06.rdata")
load("lassodataMYCsign2017-02-06.rdata")
load("lscodataBSUB2017-02-06.rdata")
load("lscodataMYC2017-02-06.rdata")
load("lscodataMYCsign2017-02-06.rdata")
load("tlscodataBSUB2017-02-06.rdata")
load("tlscodataMYC2017-02-06.rdata")
load("tlscodataMYCsign2017-02-06.rdata")
# ### LOAD PLOT DATA ###
load("lassoMYCsignlinkplotdata2017-02-08.rdata")
load("lassoMYClinkplotdata2017-02-08.rdata")
load("lassoBSUBlinkplotdata2017-02-08.rdata")
load("lscoMYCsignlinkplotdata2017-02-14.rdata")
load("lscoMYClinkplotdata2017-02-08.rdata")
load("lscoBSUBlinkplotdata2017-02-08.rdata")
load("tlscoMYCsignlinkplotdata2017-02-08.rdata")
load("tlscoMYClinkplotdata2017-02-08.rdata")
load("tlscoBSUBlinkplotdata2017-02-08.rdata")
ddd<-list(lassodataMYC=lassodataMYC,lscodataMYC=lscodataMYC,tlscodataMYC=tlscodataMYC,lassodataMYCsign=lassodataMYCsign,lscodataMYCsign=lscodataMYCsign,tlscodataMYCsign=tlscodataMYCsign,lassodataBSUB=lassodataBSUB,lscodataBSUB=lscodataBSUB,tlscodataBSUB=tlscodataBSUB)
eee<-list(lassoMYClinkplotdata=lassoMYClinkplotdata,lscoMYClinkplotdata=lscoMYClinkplotdata,tlscoMYClinkplotdata=tlscoMYClinkplotdata,lassoMYCsignlinkplotdata=lassoMYCsignlinkplotdata,lscoMYCsignlinkplotdata=lscoMYCsignlinkplotdata,tlscoMYCsignlinkplotdata=tlscoMYCsignlinkplotdata,lassoBSUBlinkplotdata=lassoBSUBlinkplotdata,lscoBSUBlinkplotdata=lscoBSUBlinkplotdata,tlscoBSUBlinkplotdata=tlscoBSUBlinkplotdata)
fff<-list(lassonameMYC=lassonameMYC,lsconameMYC=lsconameMYC,tlsconameMYC=tlsconameMYC,lassonameMYCsign=lassonameMYCsign,lsconameMYCsign=lsconameMYCsign,tlsconameMYCsign=tlsconameMYCsign,lassonameBSUB=lassonameBSUB,lsconameBSUB=lsconameBSUB,tlsconameBSUB=tlsconameBSUB)
ggg<-list(lassoMYClinkcutdata=lassoMYClinkcutdata,lscoMYClinkcutdata=lscoMYClinkcutdata,tlscoMYClinkcutdata=tlscoMYClinkcutdata,lassoMYCsignlinkcutdata=lassoMYCsignlinkcutdata,lscoMYCsignlinkcutdata=lscoMYCsignlinkcutdata,tlscoMYCsignlinkcutdata=tlscoMYCsignlinkcutdata,lassoBSUBlinkcutdata=lassoBSUBlinkcutdata,lscoBSUBlinkcutdata=lscoBSUBlinkcutdata,tlscoBSUBlinkcutdata=tlscoBSUBlinkcutdata)
wee<-paste(input$method,input$data,"linkplotdata",sep="")
datum<-(eee[[wee]])
data<-(datum[[input$sparsity]])
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
zee<-paste(input$method,input$data,"linkcutdata",sep="")
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[input$sparsity]])
cutoff<-data.frame(cutoff)
if (identical(input$data, "MYCsign")){
cutoff$CUT<-cutoff$support.at.cross2}
else{
cutoff$CUT<-cutoff$support.at.cross}
long <- melt(data, id.vars = c("bins"))
long$bins<-as.numeric(long$bins)
long$value<-as.numeric(long$value)
intercept1=cutoff$support.at.cross2[2]
ccc=max(long[c(10:1001,1010:2002),]$value)
gg<-ggplot(data=long[c(10:1001,1010:2002),],aes(bins/1000,value/max(value),colour=variable))+geom_line()+
geom_line(data=long[2003:4004,],aes(bins/1000,value,colour=variable))+ xlab("Support")+ylab("Overlap")+
# geom_vline(xintercept=intercept1)+
# scale_x_continuous(sec.axis = sec_axis(~./1000))+
scale_y_continuous(sec.axis = sec_axis(~.*ccc,name="Frequency"))
ww<-plotly_build(gg) %>% add_trace(x = cutoff$CUT[1], y = c(0,1),type='scatter',mode='lines',name="support at cutoff") %>% add_trace(x = cutoff$sparsity[1], y = c(0,1),type='scatter',mode='lines',name="sparsity")
input<-eee
wee<-paste(input$method,input$data,"linkplotdata",sep="")
datum<-(eee[[wee]])
data<-(datum[[input$sparsity]])
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
zee<-paste(input$method,input$data,"linkcutdata",sep="")
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[input$sparsity]])
cutoff<-data.frame(cutoff)
if (identical(input$data, "MYCsign")){
cutoff$CUT<-cutoff$support.at.cross2}
else{
cutoff$CUT<-cutoff$support.at.cross}
long <- melt(data, id.vars = c("bins"))
long$bins<-as.numeric(long$bins)
long$value<-as.numeric(long$value)
intercept1=cutoff$support.at.cross2[2]
ccc=max(long[c(10:1001,1010:2002),]$value)
gg<-ggplot(data=long[c(10:1001,1010:2002),],aes(bins/1000,value/max(value),colour=variable))+geom_line()+
geom_line(data=long[2003:4004,],aes(bins/1000,value,colour=variable))+ xlab("Support")+ylab("Overlap")+
# geom_vline(xintercept=intercept1)+
# scale_x_continuous(sec.axis = sec_axis(~./1000))+
scale_y_continuous(sec.axis = sec_axis(~.*ccc,name="Frequency"))
ww<-plotly_build(gg) %>% add_trace(x = cutoff$CUT[1], y = c(0,1),type='scatter',mode='lines',name="support at cutoff") %>% add_trace(x = cutoff$sparsity[1], y = c(0,1),type='scatter',mode='lines',name="sparsity")
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
runApp()
install.packages(c("httr", "knitr", "Matrix", "rlang", "rsconnect", "shiny", "tibble", "tidyr"))
shiny::runApp()
wee<-lassoMYClinkplotdata
datum<-(eee[[wee]])
data<-(datum[[input$sparsity]])
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[input$sparsity]])
cutoff<-data.frame(cutoff)
if (identical(input$data, "MYCsign")){
cutoff$CUT<-cutoff$support.at.cross2}
else{
cutoff$CUT<-cutoff$support.at.cross}
wee<-lassoMYCsignlinkplotdata
wee<-"lassoMYCsignlinkplotdata"
datum<-(eee[[wee]])
data<-(datum[[input$sparsity]])
data<-(datum[[12]])
if (identical(input$data, "MYCsign")){
data<-data.frame(data[1:1001,c(2,7,8,9,10)])}
else{
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
zee<-paste(input$method,input$data,"linkcutdata",sep="")
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[input$sparsity]])
cutoff<-data.frame(cutoff)
if (identical(input$data, "MYCsign")){
cutoff$CUT<-cutoff$support.at.cross2}
else{
cutoff$CUT<-cutoff$support.at.cross}
long <- melt(data, id.vars = c("bins"))
long$bins<-as.numeric(long$bins)
long$value<-as.numeric(long$value)
intercept1=cutoff$support.at.cross2[2]
ccc=max(long[c(10:1001,1010:2002),]$value)
data<-data.frame(data[1:1001,c(2,3,4,5,6)])}
data<-data.frame(data[1:1001,c(2,3,4,5,6)])
zee<-"lassoMYCsignlinkcutdata"
cutoffs<-(ggg[[zee]])
cutoff<-(cutoffs[[12]])
cutoff<-data.frame(cutoff)
cutoff$CUT<-cutoff$support.at.cross
long <- melt(data, id.vars = c("bins"))
long$bins<-as.numeric(long$bins)
long$value<-as.numeric(long$value)
intercept1=cutoff$support.at.cross2[2]
ccc=max(long[c(10:1001,1010:2002),]$value)
gg<-ggplot(data=long[c(10:1001,1010:2002),],aes(bins/1000,value/max(value),colour=variable))+geom_line()+
geom_line(data=long[2003:4004,],aes(bins/1000,value,colour=variable))+ xlab("Support")+ylab("Overlap")+
# geom_vline(xintercept=intercept1)+
# scale_x_continuous(sec.axis = sec_axis(~./1000))+
scale_y_continuous(sec.axis = sec_axis(~.*ccc,name="Frequency"))
ww<-plotly_build(gg) %>% add_trace(x = cutoff$CUT[1], y = c(0,1),type='scatter',mode='lines',name="support at cutoff") %>% add_trace(x = cutoff$sparsity[1], y = c(0,1),type='scatter',mode='lines',name="sparsity")%>%
layout(legend = list(orientation = 'h'))
ww
source('~/.active-rstudio-document')
ww  %>%layout(
title = "Bootstrap Support",
xaxis = list(title="Support"),
yaxis = list(range=c(0,1),side = 'left',title="Overlap"),
yaxis2 = list(range = c(0, ccc), side = 'right', overlaying = "y",title="Frequency")
)
plotly_POST(ww, filename = "1531overlap")
Sys.setenv("plotly_username"="dcolinmorgan")
Sys.setenv("plotly_api_key"="lqg9C8LlefC3OrL4MQME")
plotly_POST(ww, filename = "1531overlap")
api_create(ww, filename = "1531overlap")
gg
long <- melt(data, id.vars = c("bins"))
runApp()
library(gtools)
setwd("~/Dropbox/SciLifeLab/PROJECTS/nestBoot_MYC/Bolasso/MYCBolasso524-Feb-2017/cytoscape_net_signed/")
setwd("~/Dropbox/SciLifeLab/PROJECTS/nestBoot_MYC/Bolasso/signMYCBolasso524-Feb-2017/cytoscape_net_signed/")
setwd("~/Dropbox/SciLifeLab/PROJECTS/nestBoot_MYC/Bolasso/signMYCBolasso524-Feb-2017/signed_cytoscape_net/")
lassonameMYCsign<-rev(mixedsort(list.files(pattern = "*.tsv"))) #TSV
lassodataMYCsign <- lapply(lassonameMYCsign, read.csv, header=FALSE,sep='\t') #TSV push edited cytoscape csv output
file<-paste("~/Dropbox/SciLifeLab/git/R/GSnetApp/lassodataMYCsign",Sys.Date(),".rdata",sep="")
save(lassodataMYCsign,lassonameMYCsign,file=file)
setwd("~/Dropbox/SciLifeLab/PROJECTS/nestBoot_MYC/Bolasso/signMYCBolasso524-Feb-2017/plot-data/")
lassoMYCsignlinkplotname<-rev(mixedsort(list.files(pattern = "*.dat"))) #TSV
lassoMYCsignlinkplotdata <- lapply(lassoMYCsignlinkplotname, read.delim, header=TRUE,sep='\t',skip=1)
lassoMYCsignlinkcutdata <- lapply(lassoMYCsignlinkplotname, read.delim, header=TRUE,sep='\t',skip=1003)
file<-paste("~/Dropbox/SciLifeLab/git/R/GSnetApp/lassoMYCsignlinkplotdata",Sys.Date(),".rdata",sep="")
save(lassoMYCsignlinkplotdata,lassoMYCsignlinkcutdata,lassoMYCsignlinkplotname,file=file)
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
lassoMYClinkcutdata
lassoMYCsignlinkcutdata
View(cutoff)
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
runApp('~/Dropbox/SciLifeLab/git/R/GSnetApp')
